(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(t,e,n){t.exports=n.p+"static/media/logo.5d5d9eef.svg"},15:function(t,e,n){},18:function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),i=n(7),r=n.n(i),s=n(1),l=n(2),c=n(4),u=n(3),p=n(5),d=(n(14),n(15),window.L),h=n(17),m=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(c.a)(this,Object(u.a)(e).call(this,t))).startLocationPopup=null,n.endLocationPopup=null,n.state={},n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"componentWillReceiveProps",value:function(t){var e={closeOnClick:!1,autoClose:!1};this.props.startLocation!==t.startLocation&&(null!=this.startLocationPopup&&this.mymap.removeLayer(this.startLocationPopup),this.startLocationPopup=new d.popup(e).setLatLng(t.startLocation).setContent("Start location"),this.startLocationPopup.openOn(this.mymap)),this.props.endLocation!==t.endLocation&&(null!=this.endLocationPopup&&this.mymap.removeLayer(this.endLocationPopup),this.endLocationPopup=new d.popup(e).setLatLng(t.endLocation).setContent("End location"),this.endLocationPopup.openOn(this.mymap)),this.props.findRouteResultRev!=t.findRouteResultRev&&this.plotFindRoutesResponse(t.findRouteResult)}},{key:"plotFindRoutesResponse",value:function(t){var e=function(){var t=function(){return"0123456789abcdef"[Math.floor(16*Math.random())]};return"#"+t()+t()+t()},n=t.directions.routes[0],o=!0,a=!1,i=void 0;try{for(var r,s=n.legs[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value,c=e(),u=!0,p=!1,m=void 0;try{for(var f,y=l.steps[Symbol.iterator]();!(u=(f=y.next()).done);u=!0){var L=f.value,v=h.decode(L.polyline.points,5),b=new d.polyline(v,{color:c});this.mymap.addLayer(b),b.bindTooltip("TODO Polyline  tooltip content: "+c)}}catch(k){p=!0,m=k}finally{try{u||null==y.return||y.return()}finally{if(p)throw m}}}}catch(k){a=!0,i=k}finally{try{o||null==s.return||s.return()}finally{if(a)throw i}}}},{key:"componentDidMount",value:function(){var t=this;this.mymap=d.map("leaftlet-map-id").setView([51.505,-.09],13),d.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(this.mymap);this.mymap.on("click",function(e){t.props.handleClickOnMap(e.latlng)})}},{key:"render",value:function(){return a.a.createElement("div",{id:"leaftlet-map-id"})}}]),e}(o.Component),f=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={checkedCheckboxes:[],startLocation:null,awaitingForStartLocation:!1,endLocation:null,awaitingForEndLocation:!1},n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"componentWillReceiveProps",value:function(t){this.state.props!==t.lastMapClickCoords&&(this.state.awaitingForStartLocation&&(this.setState({awaitingForStartLocation:!1,startLocation:t.lastMapClickCoords}),this.props.notifyNewStartLocation(t.lastMapClickCoords)),this.state.awaitingForEndLocation&&(this.setState({awaitingForEndLocation:!1,endLocation:t.lastMapClickCoords}),this.props.notifyNewEndLocation(t.lastMapClickCoords)))}},{key:"renderCheckbox",value:function(t){var e=this;return[a.a.createElement("input",{type:"checkbox",id:t,name:t,value:t,onClick:function(n){var o=e.state.checkedCheckboxes.slice();if(n.target.checked)o.push(t);else{var a=o.indexOf(t);o.splice(a,1)}e.setState({checkedCheckboxes:o})}}),a.a.createElement("label",{htmlFor:t},t),a.a.createElement("br",null)]}},{key:"renderFindRoutesButton",value:function(){var t=this;return a.a.createElement("button",{type:"button",onClick:function(){var e={placesOfInterest:t.state.checkedCheckboxes,startLocation:t.state.startLocation,endLocation:t.state.endLocation};fetch("/api/maps/find_route",{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(e){t.props.notifyFindRouteResult(e)})}},"Ok - find optimal route")}},{key:"renderStartEndTripLocationsInput",value:function(){var t=this,e=function(){t.setState({awaitingForStartLocation:!0,awaitingForEndLocation:!1})},n=function(){t.setState({awaitingForEndLocation:!0,awaitingForStartLocation:!1})};return[a.a.createElement("p",null,"Your trip start-point location: "),null==this.state.startLocation?a.a.createElement("p",{style:{color:"red"}},"You havent set your start location!"):a.a.createElement("p",null,JSON.stringify(this.state.startLocation)),null==this.state.startLocation?a.a.createElement("button",{type:"button",onClick:e},"Set your start position"):a.a.createElement("button",{type:"button",onClick:e},"Update start position"),a.a.createElement("br",null),a.a.createElement("hr",null),a.a.createElement("p",null,"Your trip end-point location: "),null==this.state.endLocation?a.a.createElement("p",{style:{color:"red"}},"You havent set your end location!"):a.a.createElement("p",null,JSON.stringify(this.state.endLocation)),null==this.state.endLocation?a.a.createElement("button",{type:"button",onClick:n},"Set your end position"):a.a.createElement("button",{type:"button",onClick:n},"Update end position"),a.a.createElement("hr",null)]}},{key:"render",value:function(){return a.a.createElement("form",null,this.renderStartEndTripLocationsInput(),this.renderCheckbox("restaurants"),this.renderCheckbox("liquor stores"),this.renderCheckbox("museums"),this.renderFindRoutesButton())}}]),e}(o.Component),y=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={lastMapClickCoords:null,startLocation:null,endLocation:null,findRouteResult:null,findRouteResultRev:0},n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"handleClickOnMap",value:function(t){this.setState({lastMapClickCoords:t})}},{key:"handleNewStartLocation",value:function(t){this.setState({startLocation:t})}},{key:"handleNewEndLocation",value:function(t){this.setState({endLocation:t})}},{key:"handleFindRouteResult",value:function(t){var e=this.state.findRouteResultRev+1,n={directions:JSON.parse(t.directions)};this.setState({findRouteResult:n,findRouteResultRev:e})}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h2",null," Title to be done "),a.a.createElement("span",null,a.a.createElement("div",{style:{display:"inline-block",marginRight:"20px"}},a.a.createElement(m,{handleClickOnMap:this.handleClickOnMap.bind(this),startLocation:this.state.startLocation,endLocation:this.state.endLocation,findRouteResult:this.state.findRouteResult,findRouteResultRev:this.state.findRouteResultRev})),a.a.createElement("div",{style:{display:"inline-block",width:"600px"}},a.a.createElement(f,{lastMapClickCoords:this.state.lastMapClickCoords,notifyNewStartLocation:this.handleNewStartLocation.bind(this),notifyNewEndLocation:this.handleNewEndLocation.bind(this),notifyFindRouteResult:this.handleFindRouteResult.bind(this)}))))}}]),e}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},8:function(t,e,n){t.exports=n(18)}},[[8,2,1]]]);
//# sourceMappingURL=main.bd70f1c7.chunk.js.map