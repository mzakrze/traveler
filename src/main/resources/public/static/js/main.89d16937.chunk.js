(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(t,e,n){t.exports=n.p+"static/media/logo.5d5d9eef.svg"},16:function(t,e,n){},19:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),i=n(7),r=n.n(i),l=n(1),s=n(2),c=n(4),u=n(3),p=n(5),d=(n(15),n(16),window.L),h=n(18),m=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(c.a)(this,Object(u.a)(e).call(this,t))).startLocationPopup=null,n.endLocationPopup=null,n.state={},n}return Object(p.a)(e,t),Object(s.a)(e,[{key:"componentWillReceiveProps",value:function(t){var e={closeOnClick:!1,autoClose:!1};this.props.startLocation!==t.startLocation&&(null!=this.startLocationPopup&&this.mymap.removeLayer(this.startLocationPopup),this.startLocationPopup=new d.popup(e).setLatLng(t.startLocation).setContent("Start location"),this.startLocationPopup.openOn(this.mymap)),this.props.endLocation!==t.endLocation&&(null!=this.endLocationPopup&&this.mymap.removeLayer(this.endLocationPopup),this.endLocationPopup=new d.popup(e).setLatLng(t.endLocation).setContent("End location"),this.endLocationPopup.openOn(this.mymap)),this.props.findRouteResultRev!=t.findRouteResultRev&&this.plotFindRoutesResponse(t.findRouteResult)}},{key:"plotFindRoutesResponse",value:function(t){var e=0,n=!0,a=!1,o=void 0;try{for(var i,r=t.directions[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value.routes[0],s=!0,c=!1,u=void 0;try{for(var p,m=l.legs[Symbol.iterator]();!(s=(p=m.next()).done);s=!0){var f=p.value,y=this.props.getColor(e);e++;var v=!0,b=!1,g=void 0;try{for(var L,E=f.steps[Symbol.iterator]();!(v=(L=E.next()).done);v=!0){var k=L.value,C=h.decode(k.polyline.points,5),w=new d.polyline(C,{color:y});this.mymap.addLayer(w),w.bindTooltip("TODO Polyline  tooltip content: "+y)}}catch(I){b=!0,g=I}finally{try{v||null==E.return||E.return()}finally{if(b)throw g}}}}catch(I){c=!0,u=I}finally{try{s||null==m.return||m.return()}finally{if(c)throw u}}}}catch(I){a=!0,o=I}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}var S=t.places;console.log(S),console.log(t.selectedPlaces.placesToVisitInOrder.map(function(t){return t.id}));var O=!0,R=!1,_=void 0;try{for(var P,T=S.results[Symbol.iterator]();!(O=(P=T.next()).done);O=!0){var x=P.value;t.selectedPlaces.placesToVisitInOrder;if(0!=t.selectedPlaces.placesToVisitInOrder.map(function(t){return t.id}).includes(x.place_id)){var M=x.geometry.location,F=x.name;new d.popup({closeOnClick:!1,autoClose:!1}).setLatLng(M).setContent(F).openOn(this.mymap)}}}catch(I){R=!0,_=I}finally{try{O||null==T.return||T.return()}finally{if(R)throw _}}var j={closeOnClick:!1,autoClose:!1};this.startLocationPopup=new d.popup(j).setLatLng(t.startLocation).setContent("Start location"),this.startLocationPopup.openOn(this.mymap),this.endLocationPopup=new d.popup(j).setLatLng(t.endLocation).setContent("End location"),this.endLocationPopup.openOn(this.mymap)}},{key:"componentDidMount",value:function(){var t=this;this.mymap=d.map("leaftlet-map-id").setView([51.505,-.09],13),d.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(this.mymap);this.mymap.on("click",function(e){t.props.handleClickOnMap(e.latlng)})}},{key:"render",value:function(){return o.a.createElement("div",{id:"leaftlet-map-id"})}}]),e}(a.Component),f=n(8),y=["amusement_park","aquarium","art_gallery","bar","beauty_salon","book_store","bowling_alley","cafe","casino","church","city_hall","clothing_store","gym","hair_care","laundry","meal_takeaway","movie_rental","movie_theater","museum","night_club","park","pharmacy","store","supermarket","travel_agency","zoo"],v=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={selectedPlacesTypes:[],acceptedTravelModes:[],startLocation:null,awaitingForStartLocation:!1,endLocation:null,awaitingForEndLocation:!1,startTimeHour:"",startTimeMinute:"",tripDuration:"",placesKeywords:""},n}return Object(p.a)(e,t),Object(s.a)(e,[{key:"componentWillReceiveProps",value:function(t){this.state.props!==t.lastMapClickCoords&&(this.state.awaitingForStartLocation&&(this.setState({awaitingForStartLocation:!1,startLocation:t.lastMapClickCoords}),this.props.notifyNewStartLocation(t.lastMapClickCoords)),this.state.awaitingForEndLocation&&(this.setState({awaitingForEndLocation:!1,endLocation:t.lastMapClickCoords}),this.props.notifyNewEndLocation(t.lastMapClickCoords)))}},{key:"renderCheckbox",value:function(t){var e=this;return[o.a.createElement("input",{type:"checkbox",id:t,name:t,value:t,onClick:function(n){var a=e.state.selectedPlacesTypes.slice();if(n.target.checked)a.push(t);else{var o=a.indexOf(t);a.splice(o,1)}e.setState({selectedPlacesTypes:a})}}),o.a.createElement("label",{htmlFor:t},t),o.a.createElement("br",null)]}},{key:"renderFindRoutesButton",value:function(){var t=this;return o.a.createElement("button",{type:"button",onClick:function(){(function(){var e="";return null==t.state.startLocation&&(e+="Set your start location\n"),null==t.state.endLocation&&(e+="Set your end location\n"),""==t.state.tripDuration&&(e+="Set you trip duration\n"),""!=e&&alert(e),""==e})()&&function(){var e={placesOfInterest:t.state.selectedPlacesTypes,startLocation:t.state.startLocation,endLocation:t.state.endLocation,tripStart:""==t.state.startTimeHour&&""==t.state.startTimeMinute?null:{hour:t.state.startTimeHour,minute:t.state.startTimeMinute},tripDuration:t.state.tripDuration,placesKeywords:t.state.placesKeywords,travelModes:t.state.acceptedTravelModes};fetch("/api/maps/find_route",{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(e){null!=e.error?alert(e.error):t.props.notifyFindRouteResult(e)})}()}},"Ok - find optimal route")}},{key:"renderStartEndTripLocationsInput",value:function(){var t=this,e=function(){t.setState({awaitingForStartLocation:!0,awaitingForEndLocation:!1})},n=function(){t.setState({awaitingForEndLocation:!0,awaitingForStartLocation:!1})},a=function(e,n){t.setState(Object(f.a)({},e,n))},i=function(e){return[o.a.createElement("input",{type:"checkbox",id:e,name:e,value:e,onClick:function(n){var a=t.state.acceptedTravelModes.slice();if(n.target.checked)a.push(e);else{var o=a.indexOf(e);a.splice(o,1)}t.setState({acceptedTravelModes:a})}}),o.a.createElement("label",{htmlFor:e},e),o.a.createElement("br",null)]};return[o.a.createElement("p",null,"Your trip start-point location: "),null==this.state.startLocation?o.a.createElement("p",{style:{color:"red"}},"You havent set your start location!"):o.a.createElement("p",null,JSON.stringify(this.state.startLocation)),null==this.state.startLocation?o.a.createElement("button",{type:"button",onClick:e},"Set your start position"):o.a.createElement("button",{type:"button",onClick:e},"Update start position"),o.a.createElement("br",null),o.a.createElement("hr",null),o.a.createElement("p",null,"Your trip end-point location: "),null==this.state.endLocation?o.a.createElement("p",{style:{color:"red"}},"You havent set your end location!"):o.a.createElement("p",null,JSON.stringify(this.state.endLocation)),null==this.state.endLocation?o.a.createElement("button",{type:"button",onClick:n},"Set your end position"):o.a.createElement("button",{type:"button",onClick:n},"Update end position"),o.a.createElement("hr",null),o.a.createElement("p",null,"Your trip start time: "),o.a.createElement("label",{htmlFor:"input_start_time_hour"},"Hour:"),o.a.createElement("input",{type:"text",id:"input_start_time_hour",onChange:function(t){return a("startTimeHour",t.target.value)}}),o.a.createElement("label",{htmlFor:"input_start_time_minute"},"Minute:"),o.a.createElement("input",{type:"text",id:"input_start_time_minute",onChange:function(t){return a("startTimeMinute",t.target.value)}}),""==this.state.startTimeHour&&""==this.state.startTimeMinute?o.a.createElement("p",{style:{color:"orange"}},"You havent set start time(assuming right now)"):null,o.a.createElement("hr",null),o.a.createElement("label",{htmlFor:"input_duration_minute"},"Expected trip duration in minutes:"),o.a.createElement("input",{type:"text",id:"input_duration_minute",onChange:function(t){return a("tripDuration",t.target.value)}}),""==this.state.tripDuration?o.a.createElement("p",{style:{color:"red"}},"You havent set your trip duration"):null,o.a.createElement("hr",null),o.a.createElement("p",null,"Choose accepted modes of transportation: "),i("driving"),i("bicycling"),i("transit")]}},{key:"loadConfigFromLocalStorage",value:function(){var t=JSON.parse(localStorage.getItem("config"));this.setState(t)}},{key:"saveConfigToLocalStorage",value:function(){var t=JSON.stringify(this.state);localStorage.setItem("config",t)}},{key:"render",value:function(){var t=this;return o.a.createElement("form",null,this.renderStartEndTripLocationsInput(),o.a.createElement("p",null,"Choose places of interest: "),o.a.createElement("div",{style:{height:"200px",overflow:"scroll"}},y.map(function(e){return t.renderCheckbox(e)})),o.a.createElement("hr",null),o.a.createElement("p",null,"Additional keywords for finding places: "),o.a.createElement("label",{htmlFor:"input_keywords"},"Search for places:"),o.a.createElement("input",{type:"text",id:"input_keywords",onChange:function(e){return t.setState({placesKeywords:e.target.value})}}),o.a.createElement("hr",null),this.renderFindRoutesButton(),o.a.createElement("button",{type:"button",onClick:this.saveConfigToLocalStorage.bind(this)},"Save config"),o.a.createElement("button",{type:"button",onClick:this.loadConfigFromLocalStorage.bind(this)},"Load config"))}}]),e}(a.Component),b=function(t){function e(){return Object(l.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"renderSingleStep",value:function(t,e,n){var a=[];a.push(o.a.createElement("p",{style:{"background-color":e}},t));var i=n.routes[0],r=(i.summery,!0),l=!1,s=void 0;try{for(var c,u=i.legs[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var p=c.value,d="   "+p.distance.text+"("+p.duration.text+")";a.push(o.a.createElement("p",{onMouseEnter:function(){return console.log("xd")},onMouseLeave:function(){return console.log("xd")}},d))}}catch(h){l=!0,s=h}finally{try{r||null==u.return||u.return()}finally{if(l)throw s}}return o.a.createElement("div",null,[].concat(a))}},{key:"render",value:function(){var t=this,e=function(e){return t.props.result.places.results.filter(function(t){return t.place_id==e})[0].name},n=[];if(null!=this.props.result)for(var a=0,i=0;i<this.props.result.directions.length;i++){var r=this.props.result.directions[i],l=null,s=null;l=0==i?"Start location":e(this.props.result.selectedPlaces.placesToVisitInOrder[i-1].id),s=i==this.props.result.directions.length-1?"End location":e(this.props.result.selectedPlaces.placesToVisitInOrder[i].id);var c=this.props.getColor(a);a++,n.push(this.renderSingleStep(l+"->"+s,c,r))}return o.a.createElement("div",null,"Hello it is result presenter",n,o.a.createElement("button",{type:"button",onClick:this.props.notifyChangeScreen},"Search again"))}}]),e}(a.Component),g=function(t){function e(t){var n;return Object(l.a)(this,e),(n=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={lastMapClickCoords:null,startLocation:null,endLocation:null,findRouteResult:null,findRouteResultRev:0,resultPresenterVisible:!1},n}return Object(p.a)(e,t),Object(s.a)(e,[{key:"handleClickOnMap",value:function(t){this.setState({lastMapClickCoords:t})}},{key:"handleNewStartLocation",value:function(t){this.setState({startLocation:t})}},{key:"handleNewEndLocation",value:function(t){this.setState({endLocation:t})}},{key:"handleFindRouteResult",value:function(t){var e=this.state.findRouteResultRev+1,n=[],a=!0,o=!1,i=void 0;try{for(var r,l=t.directions[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var s=r.value;n.push(JSON.parse(s))}}catch(u){o=!0,i=u}finally{try{a||null==l.return||l.return()}finally{if(o)throw i}}var c={directions:n,places:JSON.parse(t.places),selectedPlaces:t.selectedPlaces,startLocation:t.startLocation,endLocation:t.endLocation};this.setState({findRouteResult:c,findRouteResultRev:e,resultPresenterVisible:!0})}},{key:"getColor",value:function(t){var e=["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080","#ffffff"];if(e.length<=t){var n=function(){var t=function(){return"0123456789abcdef"[Math.floor(16*Math.random())]};return"#"+t()+t()+t()}();return e.push(n),n}return e[t]}},{key:"render",value:function(){var t=this,e=this.state.resultPresenterVisible?"none":"inline-block",n=0==this.state.resultPresenterVisible?"none":"inline-block";return o.a.createElement("div",null,o.a.createElement("h2",null," Title to be done "),o.a.createElement("span",null,o.a.createElement("div",{style:{display:"inline-block",marginRight:"20px"}},o.a.createElement(m,{handleClickOnMap:this.handleClickOnMap.bind(this),startLocation:this.state.startLocation,endLocation:this.state.endLocation,findRouteResult:this.state.findRouteResult,findRouteResultRev:this.state.findRouteResultRev,getColor:this.getColor})),o.a.createElement("div",{style:{display:e,width:"600px"}},o.a.createElement(v,{lastMapClickCoords:this.state.lastMapClickCoords,notifyNewStartLocation:this.handleNewStartLocation.bind(this),notifyNewEndLocation:this.handleNewEndLocation.bind(this),notifyFindRouteResult:this.handleFindRouteResult.bind(this)})),o.a.createElement("div",{style:{display:n,width:"600px"}},o.a.createElement(b,{notifyChangeScreen:function(){return t.setState({resultPresenterVisible:!1})},result:this.state.findRouteResult,getColor:this.getColor}))))}}]),e}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},9:function(t,e,n){t.exports=n(19)}},[[9,2,1]]]);
//# sourceMappingURL=main.89d16937.chunk.js.map